<!DOCTYPE html>
<html>
<head>
  <title>Mage Knight Companion</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    h1 {
      color: #333;
    }
    .section {
      margin-bottom: 30px;
    }
    button {
      margin: 5px;
      padding: 6px 10px;
    }
    .output {
      background: #fff;
      padding: 10px;
      border-radius: 5px;
    }
    .track-container {
      padding: 10px;
      background: #eaeaea;
      border-radius: 8px;
    }
    .fame-grid {
      display: grid;
      grid-template-columns: repeat(51, 30px);
      gap: 2px;
      margin-top: 10px;
    }
    .rep-grid {
      display: grid;
      grid-template-rows: repeat(15, 30px);
      gap: 2px;
      margin-top: 10px;
      height: 450px;
    }
    .fame-cell, .rep-cell {
      background: #ddd;
      text-align: center;
      font-size: 12px;
      padding: 5px;
      border-radius: 4px;
    }
    .marker {
      position: absolute;
      font-size: 20px;
      transition: all 0.3s ease;
    }
    .fame-track, .rep-track {
      position: relative;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>Mage Knight Dummy Player Companion</h1>

  <div class="section">
    <h2>Crystals</h2>
    üî¥ Red: <span id="red">0</span>
    <button onclick="changeCrystal('red', 1)">‚ûï</button>
    <button onclick="changeCrystal('red', -1)">‚ûñ</button><br>
    üîµ Blue: <span id="blue">0</span>
    <button onclick="changeCrystal('blue', 1)">‚ûï</button>
    <button onclick="changeCrystal('blue', -1)">‚ûñ</button><br>
    üü¢ Green: <span id="green">0</span>
    <button onclick="changeCrystal('green', 1)">‚ûï</button>
    <button onclick="changeCrystal('green', -1)">‚ûñ</button><br>
    ‚ö™ White: <span id="white">0</span>
    <button onclick="changeCrystal('white', 1)">‚ûï</button>
    <button onclick="changeCrystal('white', -1)">‚ûñ</button>
  </div>

  <div class="section track-container">
    <h2>Fame Track</h2>
    <div class="fame-track">
      <div id="fame-marker" class="marker">‚≠ê</div>
      <div class="fame-grid"></div>
    </div>

    <h2>Reputation Track</h2>
    <div class="rep-track">
      <div id="rep-marker" class="marker">üß≠</div>
      <div class="rep-grid"></div>
    </div>
  </div>

  <div class="section">
    <button onclick="changeFame(1)">+1 Fame</button>
    <button onclick="changeFame(-1)">-1 Fame</button>
    <button onclick="changeReputation(1)">+1 Rep</button>
    <button onclick="changeReputation(-1)">-1 Rep</button>
  </div>

  <div class="section">
    <h2>Dummy Deck</h2>
    <button onclick="addCard('Red')">+ Red Card</button>
    <button onclick="addCard('Blue')">+ Blue Card</button>
    <button onclick="addCard('Green')">+ Green Card</button>
    <button onclick="addCard('White')">+ White Card</button>
    <button onclick="resetDeck()">Reset Deck</button>
    <p>Cards left in deck: <span id="deck-count">16</span></p>
  </div>

  <div class="section">
    <h2>Draw Cards</h2>
    <button onclick="drawDummyCards()">Draw Dummy Cards</button>
    <div class="output">
      <p id="dummy-output">Drawn cards will appear here.</p>
    </div>
  </div>

  <div class="section">
    <h2>Discard Pile</h2>
    <div class="output">
      <p id="discard-output">Discard pile is empty.</p>
    </div>
  </div>

  <script>
    let fame = 0;
    let reputation = 0;
    let crystals = { red: 0, blue: 0, green: 0, white: 0 };
    let dummyDeck = [];
    let discardPile = [];

    const fameGrid = document.querySelector(".fame-grid");
    const repGrid = document.querySelector(".rep-grid");
    const fameMarker = document.getElementById("fame-marker");
    const repMarker = document.getElementById("rep-marker");

    for (let i = 0; i <= 50; i++) {
      const cell = document.createElement("div");
      cell.className = "fame-cell";
      cell.textContent = i;
      fameGrid.appendChild(cell);
    }

    for (let i = -7; i <= 7; i++) {
      const cell = document.createElement("div");
      cell.className = "rep-cell";
      cell.textContent = i;
      repGrid.appendChild(cell);
    }

    function updateFameMarker() {
      fameMarker.style.left = `${fame * 32}px`;
    }

    function updateRepMarker() {
      const offset = (reputation + 7) * 32;
      repMarker.style.top = `${offset}px`;
    }

    function changeFame(amount) {
      fame = Math.max(0, Math.min(50, fame + amount));
      updateFameMarker();
    }

    function changeReputation(amount) {
      reputation = Math.max(-7, Math.min(7, reputation + amount));
      updateRepMarker();
    }

    function changeCrystal(color, amount) {
      crystals[color] = Math.max(0, crystals[color] + amount);
      document.getElementById(color).textContent = crystals[color];
    }

    function initializeDeck() {
      dummyDeck = [
        ...Array(4).fill("Red Card"),
        ...Array(4).fill("Blue Card"),
        ...Array(4).fill("Green Card"),
        ...Array(4).fill("White Card")
      ];
      discardPile = [];
      updateDeckCount();
      updateDiscardPile();
    }

    function addCard(color) {
      dummyDeck.push(`${color} Card`);
      updateDeckCount();
    }

    function resetDeck() {
      initializeDeck();
      document.getElementById("dummy-output").textContent = "Deck reset to 16 cards.";
    }

    function drawDummyCards() {
      let drawn = [];

      for (let i = 0; i < 3 && dummyDeck.length > 0; i++) {
        let index = Math.floor(Math.random() * dummyDeck.length);
        drawn.push(dummyDeck.splice(index, 1)[0]);
      }

      let lastCard = drawn[drawn.length - 1];
      if (lastCard) {
        let color = lastCard.split(" ")[0].toLowerCase();
        let extraDraws = crystals[color] || 0;

        for (let i = 0; i < extraDraws && dummyDeck.length > 0; i++) {
          let index = Math.floor(Math.random() * dummyDeck.length);
          drawn.push(dummyDeck.splice(index, 1)[0]);
        }
      }

      discardPile.push(...drawn);
      document.getElementById("dummy-output").textContent = `Dummy draws: ${drawn.join(", ")}`;
      updateDeckCount();
      updateDiscardPile();
    }

    function updateDeckCount() {
      document.getElementById("deck-count").textContent = dummyDeck.length;
    }

    function updateDiscardPile() {
      document.getElementById("discard-output").textContent =
        discardPile.length === 0
          ? "Discard pile is empty."
          : `Discard pile: ${discardPile.join(", ")}`;
    }

    initializeDeck();
    updateFameMarker();
    updateRepMarker();
  </script>
</body>
</html>
